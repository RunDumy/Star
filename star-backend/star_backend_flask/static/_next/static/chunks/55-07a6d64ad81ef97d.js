"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55],{55:(t,n,e)=>{e.d(n,{A:()=>N});var o=e(2969),r=e(5794),i=e(3857),a=e(3081),s=e.n(a),c=e(4232),u=e(1320),l=e(1648),f=e(3191),d=e(9745),p=e(4516),v=e(9070),h=e(5302),m=e(5003),y=e(8230),g=e.n(y),x=e(4796),w=e(7876);function b(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function j(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?b(Object(e),!0).forEach(function(n){(0,o.A)(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):b(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}var z=(0,l.b)({time:0,color:new x.Color(1,1,1),distortionStrength:.2,zodiacType:0},"\n    varying vec2 vUv;\n    varying vec3 vNormal;\n    void main() {\n      vUv = uv;\n      vNormal = normalize(normalMatrix * normal);\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ","\n    uniform float time;\n    uniform vec3 color;\n    uniform float distortionStrength;\n    uniform int zodiacType;\n    varying vec2 vUv;\n    varying vec3 vNormal;\n    void main() {\n      vec2 uv = vUv;\n      float t = time * 0.5;\n      float distortion = 0.0;\n      if (zodiacType == 0) {\n        distortion = sin(uv.x * 10.0 + t) * cos(uv.y * 10.0 + t) * distortionStrength;\n      } else if (zodiacType == 1) {\n        float angle = atan(uv.y - 0.5, uv.x - 0.5);\n        distortion = sin(angle * 5.0 + t) * distortionStrength;\n      } else if (zodiacType == 2) {\n        distortion = sin(length(uv - 0.5) * 20.0 + t) * distortionStrength;\n      } else {\n        distortion = sin(uv.y * 15.0 + t) * distortionStrength;\n      }\n      uv += vNormal.xy * distortion;\n      float intensity = 0.5 + 0.5 * sin(t + uv.x * 5.0);\n      gl_FragColor = vec4(color * intensity, intensity * 0.3);\n    }\n  "),C=(0,l.b)({time:0,baseColor:new x.Color(1,1,1),secondaryColor:new x.Color(1,1,1),strength:.5,zodiacType:0,tarotBurst:0,transitBurst:0,glowBurst:0,moodIntensity:.5},"\n    varying vec2 vUv;\n    varying vec3 vPosition;\n    void main() {\n      vUv = uv;\n      vPosition = position;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ","\n    uniform float time;\n    uniform vec3 baseColor;\n    uniform vec3 secondaryColor;\n    uniform float strength;\n    uniform int zodiacType;\n    uniform float tarotBurst;\n    uniform float transitBurst;\n    uniform float glowBurst;\n    uniform float moodIntensity;\n    varying vec2 vUv;\n    varying vec3 vPosition;\n\n    float noise(vec2 p) {\n      return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);\n    }\n\n    void main() {\n      vec2 uv = vUv;\n      float t = time * 0.8;\n      float glow = strength;\n      float pulse = 0.5 + 0.5 * sin(t * (1.0 + moodIntensity)); // Mood-specific pulsing\n\n      if (zodiacType == 0) { // Passionate\n        float n = noise(uv * 10.0 + t);\n        glow *= 0.5 + 0.5 * sin(t + n * 2.0);\n      } else if (zodiacType == 1) { // Curious\n        float angle = atan(uv.y - 0.5, uv.x - 0.5);\n        glow *= 0.6 + 0.4 * cos(angle * 5.0 + t);\n      } else if (zodiacType == 2) { // Reflective\n        float n = noise(uv * 5.0 + t);\n        glow *= 0.5 + 0.5 * sin(length(uv - 0.5) * 15.0 + t + n);\n      } else if (zodiacType == 3) { // Serene\n        glow *= 0.6 + 0.4 * sin(uv.y * 10.0 + t);\n      } else { // Neutral\n        glow *= 0.5 + 0.5 * sin(t + uv.x * 5.0);\n      }\n\n      // Color blending\n      vec3 color = mix(baseColor, secondaryColor, 0.5 + 0.5 * sin(t * 0.5));\n      glow += tarotBurst * (0.5 + 0.5 * sin(t * 2.0));\n      glow += transitBurst * (0.7 + 0.3 * sin(t * 3.0));\n      glow += glowBurst * (1.0 + 0.5 * sin(t * 4.0));\n      gl_FragColor = vec4(color * glow * pulse, glow * 0.7);\n    }\n  "),_=(0,l.b)({time:0,color:new x.Color(1,1,1),opacity:.8},"\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ","\n    uniform float time;\n    uniform vec3 color;\n    uniform float opacity;\n    varying vec2 vUv;\n\n    void main() {\n      float shimmer = 0.5 + 0.5 * sin(vUv.x * 10.0 + time * 2.0);\n      gl_FragColor = vec4(color, opacity * shimmer);\n    }\n  "),P=(0,l.b)({time:0,color:new x.Color(1,1,1),moodType:0},"\n    attribute vec3 velocity;\n    varying vec3 vPosition;\n    void main() {\n      vPosition = position + velocity * 0.05;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);\n      gl_PointSize = 2.0;\n    }\n  ","\n    uniform float time;\n    uniform vec3 color;\n    uniform int moodType;\n    varying vec3 vPosition;\n\n    void main() {\n      float t = time * 0.7;\n      float intensity = 0.5;\n\n      if (moodType == 0) { // Passionate\n        intensity = 0.5 + 0.5 * sin(t + vPosition.x * 6.0);\n      } else if (moodType == 1) { // Curious\n        intensity = 0.6 + 0.4 * cos(atan(vPosition.y, vPosition.x) * 4.0 + t);\n      } else if (moodType == 2) { // Reflective\n        intensity = 0.5 + 0.5 * sin(length(vPosition.xy) * 12.0 + t);\n      } else if (moodType == 3) { // Serene\n        intensity = 0.6 + 0.4 * sin(vPosition.y * 8.0 + t);\n      } else { // Neutral\n        intensity = 0.5 + 0.5 * sin(t + vPosition.z * 5.0);\n      }\n\n      gl_FragColor = vec4(color * intensity, intensity * 0.7);\n    }\n  "),S=(0,l.b)({time:0,color:new x.Color(1,1,1),zodiacType:0},"\n    attribute vec3 velocity;\n    varying vec3 vPosition;\n    void main() {\n      vPosition = position + velocity * 0.1;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);\n      gl_PointSize = 3.0;\n    }\n  ","\n    uniform float time;\n    uniform vec3 color;\n    uniform int zodiacType;\n    varying vec3 vPosition;\n\n    void main() {\n      float t = time * 0.5;\n      float intensity = 0.5;\n\n      if (zodiacType == 0) {\n        intensity = 0.5 + 0.5 * sin(t + vPosition.x * 5.0);\n      } else if (zodiacType == 1) {\n        intensity = 0.6 + 0.4 * cos(atan(vPosition.y, vPosition.x) * 3.0 + t);\n      } else if (zodiacType == 2) {\n        intensity = 0.5 + 0.5 * sin(length(vPosition.xy) * 10.0 + t);\n      } else {\n        intensity = 0.6 + 0.4 * sin(vPosition.y * 5.0 + t);\n      }\n\n      gl_FragColor = vec4(color * intensity, intensity * 0.8);\n    }\n  ");function T(){for(var t=(0,c.useRef)(null),n=new Float32Array(3e3),e=0;e<1e3;e++)n[3*e]=(Math.random()-.5)*100,n[3*e+1]=(Math.random()-.5)*100,n[3*e+2]=(Math.random()-.5)*100;return(0,v.F)(function(){t.current&&(t.current.rotation.y+=5e-4)}),(0,w.jsx)("primitive",{object:t.current})}function A(){var t=(0,c.useRef)(null);return(0,v.F)(function(n){var e=n.clock;t.current&&(t.current.rotation.y+=.001,t.current.material.uniforms.time.value=e.getElapsedTime())}),(0,w.jsxs)("mesh",{ref:t,children:[(0,w.jsx)("sphereGeometry",{args:[50,32,32]}),(0,w.jsx)(z,{color:new x.Color("#4a0e4e"),distortionStrength:.1,zodiacType:2})]})}function M(t){var n,e=t.position,o=t.text,r=t.href,a=t.zodiac,l=t.size,d=void 0===l?.5:l,p=t.color,h=t.isMoon,m=void 0!==h&&h,y=(0,c.useRef)(null),b=(0,c.useRef)(null),j=(0,c.useState)(!1),C=j[0],_=j[1],P=(0,u.A)().user,S={Aries:new x.Color("#ff4500"),Leo:new x.Color("#ffd700"),Virgo:new x.Color("#00ff7f"),Libra:new x.Color("#1e90ff")};(0,v.F)(function(t){var n=t.clock;y.current&&(y.current.rotation.y+=m?.02:.01,y.current.scale.setScalar(C?1.2*d:d)),b.current&&(b.current.scale.setScalar(C?1.6*d:1.4*d),b.current.material.uniforms.time.value=n.getElapsedTime(),b.current.material.uniforms.distortionStrength.value=C?.4:.2)});var T=(n=(0,i.A)(s().mark(function t(){return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/interactions"),{method:"POST",headers:{Authorization:"Bearer ".concat(null==P?void 0:P.id),"Content-Type":"application/json"},body:JSON.stringify({interaction_type:"aura_click",zodiac_sign:a})});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Failed to log aura interaction");case 8:case"end":return t.stop()}},t,null,[[0,5]])})),function(){return n.apply(this,arguments)});return(0,w.jsxs)("group",{position:e,children:[(0,w.jsxs)("mesh",{ref:y,onPointerOver:function(){return _(!0)},onPointerOut:function(){return _(!1)},onClick:T,children:[(0,w.jsx)("sphereGeometry",{args:[d,32,32]}),(0,w.jsx)("meshStandardMaterial",{color:C?"#ff5555":void 0===p?"#00f":p,emissive:m?"#aaa":"#333",roughness:m?.8:.4})]}),(0,w.jsxs)("mesh",{ref:b,children:[(0,w.jsx)("sphereGeometry",{args:[1.4*d,32,32]}),(0,w.jsx)(z,{color:S[a]||new x.Color("#ffffff"),zodiacType:{Aries:0,Leo:1,Virgo:2,Libra:3}[a]||0})]}),(0,w.jsx)(f.E,{position:[0,d+.3,0],fontSize:.2,color:"white",anchorX:"center",anchorY:"middle",children:"".concat(o," (").concat(a,")")}),(0,w.jsx)(g(),{href:r,className:"absolute inset-0"})]})}function k(t){var n,e,a,u=t.position,l=t.user,p=(0,c.useRef)(null),h=(0,c.useRef)(null),y=(0,c.useRef)(null),g=(0,c.useRef)([]),b=(0,c.useState)(null),z=b[0],P=b[1],T=(0,c.useState)({}),A=T[0],M=T[1],k=(0,c.useState)({}),O=k[0],B=k[1],N=(0,c.useState)({}),F=N[0],E=N[1],R=(0,c.useState)([{trait_name:"Courage",zodiac_sign:"Aries",strength:.8},{trait_name:"Creativity",zodiac_sign:"Leo",strength:.6},{trait_name:"Precision",zodiac_sign:"Virgo",strength:.7},{trait_name:"Harmony",zodiac_sign:"Libra",strength:.5}]),D=R[0],L=R[1],U={Courage:new x.Color("#ff4500"),Creativity:new x.Color("#ffd700"),Precision:new x.Color("#00ff7f"),Harmony:new x.Color("#1e90ff")},V={Courage:0,Creativity:1,Precision:2,Harmony:3},G=(0,m.useDrag)(function(t){var n=(0,r.A)(t.offset,2),e=n[0],o=(n[1],t.down);p.current&&o&&(p.current.rotation.y+=.005*e)});(0,c.useEffect)(function(){l&&fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/zodiac-dna"),{headers:{Authorization:"Bearer ".concat(l.id)}}).then(function(t){return t.json()}).then(function(t){return L(t.dna)})},[l]);for(var H=(n=(0,i.A)(s().mark(function t(){var n,e,r,i;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/tarot-pull"),{method:"POST",headers:{Authorization:"Bearer ".concat(l.id),"Content-Type":"application/json"}});case 3:return n=t.sent,t.next=6,n.json();case 6:(e=t.sent).card,r=e.trait,i=e.strength,L(function(t){return t.map(function(t){return t.trait_name===r?j(j({},t),{},{strength:i}):t})}),M(function(t){return j(j({},t),{},(0,o.A)({},r,1))}),E(function(t){return j(j({},t),{},(0,o.A)({},r,1))}),setTimeout(function(){M(function(t){return j(j({},t),{},(0,o.A)({},r,0))}),E(function(t){return j(j({},t),{},(0,o.A)({},r,0))})},1e3),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Failed to perform tarot pull");case 19:case"end":return t.stop()}},t,null,[[0,16]])})),function(){return n.apply(this,arguments)}),I=(e=(0,i.A)(s().mark(function t(){var n,e,r,i;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/transit"),{method:"GET",headers:{Authorization:"Bearer ".concat(l.id)}});case 3:return n=t.sent,t.next=6,n.json();case 6:(e=t.sent).transit,r=e.trait,i=e.strength,L(function(t){return t.map(function(t){return t.trait_name===r?j(j({},t),{},{strength:i}):t})}),B(function(t){return j(j({},t),{},(0,o.A)({},r,1))}),E(function(t){return j(j({},t),{},(0,o.A)({},r,1))}),setTimeout(function(){B(function(t){return j(j({},t),{},(0,o.A)({},r,0))}),E(function(t){return j(j({},t),{},(0,o.A)({},r,0))})},1e3),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Failed to fetch transit");case 19:case"end":return t.stop()}},t,null,[[0,16]])})),function(){return e.apply(this,arguments)}),J=D.map(function(t,n){var e=n*Math.PI*.5;return new x.Vector3(.3*Math.sin(e),.3*n-(D.length-1)*.15,.3*Math.cos(e))}),X=new Float32Array(300),W=new Float32Array(300),Z=0;Z<100;Z++){var q=Z/99,Y=Math.floor(q*(J.length-1)),K=Math.min(Y+1,J.length-1),Q=q*(J.length-1)-Y,$=J[Y].clone().lerp(J[K],Q);X[3*Z]=$.x+(Math.random()-.5)*.05,X[3*Z+1]=$.y+(Math.random()-.5)*.05,X[3*Z+2]=$.z+(Math.random()-.5)*.05,W[3*Z]=(Math.random()-.5)*.01,W[3*Z+1]=(Math.random()-.5)*.01,W[3*Z+2]=(Math.random()-.5)*.01}(0,v.F)(function(t){if(t.clock,h.current&&(h.current.rotation.y+=.01),y.current){for(var n=y.current.geometry.attributes.position.array,e=y.current.geometry.attributes.velocity.array,o=Object.values(O).some(function(t){return t>0})||Object.values(F).some(function(t){return t>0})?3:z?2:1,r=0;r<100;r++){n[3*r]+=e[3*r]*o,n[3*r+1]+=e[3*r+1]*o,n[3*r+2]+=e[3*r+2]*o;var i=r/99,a=Math.floor(i*(J.length-1)),s=Math.min(a+1,J.length-1),c=i*(J.length-1)-a,u=J[a].clone().lerp(J[s],c);Math.sqrt(Math.pow(n[3*r]-u.x,2)+Math.pow(n[3*r+1]-u.y,2)+Math.pow(n[3*r+2]-u.z,2))>.1&&(n[3*r]+=(u.x-3*n.i)*.05,n[3*r+1]+=(u.y-n[3*r+1])*.05,n[3*r+2]+=(u.z-n[3*r+2])*.05)}y.current.geometry.attributes.position.needsUpdate=!0}});var tt=(a=(0,i.A)(s().mark(function t(n){return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/zodiac-dna"),{method:"POST",headers:{Authorization:"Bearer ".concat(l.id),"Content-Type":"application/json"},body:JSON.stringify({trait_name:n.trait_name,zodiac_sign:n.zodiac_sign,strength:Math.min(n.strength+.1,1)})});case 3:return t.next=5,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/interactions"),{method:"POST",headers:{Authorization:"Bearer ".concat(l.id),"Content-Type":"application/json"},body:JSON.stringify({interaction_type:"trail_click",zodiac_sign:n.zodiac_sign})});case 5:L(function(t){return t.map(function(t){return t.trait_name===n.trait_name?j(j({},t),{},{strength:Math.min(t.strength+.1,1)}):t})}),E(function(t){return j(j({},t),{},(0,o.A)({},n.trait_name,1))}),setTimeout(function(){return E(function(t){return j(j({},t),{},(0,o.A)({},n.trait_name,0))})},1e3),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("Failed to update DNA trait or log interaction");case 13:case"end":return t.stop()}},t,null,[[0,10]])})),function(t){return a.apply(this,arguments)});return(0,w.jsxs)("group",j(j({position:u,ref:p},G()),{},{children:[(0,w.jsx)(d.N,{ref:h,points:J,color:"#ffffff",lineWidth:2}),(0,w.jsxs)("points",{ref:y,children:[(0,w.jsxs)("bufferGeometry",{children:[(0,w.jsx)("bufferAttribute",{attach:"attributes-position",array:X,count:100,itemSize:3}),(0,w.jsx)("bufferAttribute",{attach:"attributes-velocity",array:W,count:100,itemSize:3})]}),(0,w.jsx)(S,{color:U[D[0].trait_name]||new x.Color("#ffffff"),zodiacType:V[D[0].trait_name]||0,time:Date.now()/1e3})]}),D.map(function(t,n){return(0,w.jsxs)("group",{children:[(0,w.jsxs)("mesh",{position:J[n],ref:function(t){return g.current[n]=t},onPointerOver:function(){return P(t.trait_name)},onPointerOut:function(){return P(null)},onClick:function(){return tt(t)},children:[(0,w.jsx)("sphereGeometry",{args:[.1*t.strength,16,16]}),(0,w.jsx)(C,{color:U[t.trait_name]||new x.Color("#ffffff"),strength:t.strength,zodiacType:V[t.trait_name]||0,tarotBurst:A[t.trait_name]||0,transitBurst:O[t.trait_name]||0,glowBurst:F[t.trait_name]||0,time:Date.now()/1e3})]}),(0,w.jsx)(f.E,{position:[J[n].x,J[n].y+.15,J[n].z],fontSize:.12,anchorX:"center",material:new _({color:U[t.trait_name]||new x.Color("#ffffff"),opacity:.8,time:Date.now()/1e3}),children:"".concat(t.trait_name,": ").concat(t.strength.toFixed(2))})]},t.trait_name)}),(0,w.jsx)(f.E,{position:[0,-.5,0],fontSize:.2,color:"white",anchorX:"center",onClick:H,children:"Draw Tarot"}),(0,w.jsx)(f.E,{position:[0,-.8,0],fontSize:.2,color:"white",anchorX:"center",onClick:I,children:"View Transits"})]}))}function O(t){var n,e=t.position,a=t.user,u=(0,c.useRef)(null),l=(0,c.useRef)(null),p=(0,c.useRef)([]),h=(0,c.useState)([]),y=h[0],g=h[1],b=(0,c.useState)(null),z=(b[0],b[1]),_=(0,c.useState)({}),P=_[0],S=_[1],T={tarot_pull:new x.Color("#ffd700"),transit_view:new x.Color("#1e90ff"),trail_click:new x.Color("#ff4500")},A={tarot_pull:0,transit_view:1,trail_click:2};(0,c.useEffect)(function(){a&&fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/timeline"),{headers:{Authorization:"Bearer ".concat(a.id)}}).then(function(t){return t.json()}).then(function(t){return g(t.timeline)})},[a]);var M=y.map(function(t,n){var e=n*Math.PI*.4;return new x.Vector3(.5*Math.sin(e),.4*n-(y.length-1)*.2,.5*Math.cos(e))}),k=(0,m.useDrag)(function(t){var n=(0,r.A)(t.offset,2),e=n[0],o=(n[1],t.down);u.current&&o&&(u.current.rotation.y+=.005*e)});(0,v.F)(function(t){t.clock,l.current&&(l.current.rotation.y+=.01)});var O=(n=(0,i.A)(s().mark(function t(n){return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/interactions"),{method:"POST",headers:{Authorization:"Bearer ".concat(a.id),"Content-Type":"application/json"},body:JSON.stringify({interaction_type:"timeline_click",zodiac_sign:n.zodiac_sign})});case 3:S(function(t){return j(j({},t),{},(0,o.A)({},n.id,1))}),setTimeout(function(){return S(function(t){return j(j({},t),{},(0,o.A)({},n.id,0))})},1e3),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to log timeline interaction");case 10:case"end":return t.stop()}},t,null,[[0,7]])})),function(t){return n.apply(this,arguments)});return(0,w.jsxs)("group",j(j({position:e,ref:u},k()),{},{children:[(0,w.jsx)(d.N,{ref:l,points:M,color:"#ffffff",lineWidth:1.5}),y.map(function(t,n){return(0,w.jsxs)("group",{children:[(0,w.jsxs)("mesh",{position:M[n],ref:function(t){return p.current[n]=t},onPointerOver:function(){return z(t.id)},onPointerOut:function(){return z(null)},onClick:function(){return O(t)},children:[(0,w.jsx)("sphereGeometry",{args:[.08,16,16]}),(0,w.jsx)(C,{color:T[t.type]||new x.Color("#ffffff"),strength:.7,zodiacType:A[t.type]||0,tarotBurst:0,transitBurst:0,glowBurst:P[t.id]||0,time:Date.now()/1e3})]}),(0,w.jsx)(f.E,{position:[M[n].x,M[n].y+.15,M[n].z],fontSize:.1,color:T[t.type]||new x.Color("#ffffff"),children:"tarot_pull"===t.type?"Tarot: ".concat(t.details.card):"transit_view"===t.type?"Transit: ".concat(t.details.transit):"Trait Click: ".concat(t.zodiac_sign)})]},t.id)}),(0,w.jsx)(f.E,{position:[0,-.5,0],fontSize:.2,color:"white",children:"Cosmic Timeline"})]}))}function B(t){var n,e=t.position,a=t.user,u=(0,c.useRef)(null),l=(0,c.useRef)([]),d=(0,c.useRef)(null),p=(0,c.useState)({mood:"Neutral",intensity:.5}),h=p[0],y=p[1],g=(0,c.useState)(null),b=g[0],z=g[1],S=(0,c.useState)({}),T=S[0],A=S[1],M={Passionate:{base:new x.Color("#ff4500"),secondary:new x.Color("#ff8c00")},Curious:{base:new x.Color("#ffd700"),secondary:new x.Color("#ffa500")},Reflective:{base:new x.Color("#00ff7f"),secondary:new x.Color("#00cc66")},Serene:{base:new x.Color("#1e90ff"),secondary:new x.Color("#87ceeb")},Neutral:{base:new x.Color("#ffffff"),secondary:new x.Color("#cccccc")}},k={Passionate:0,Curious:1,Reflective:2,Serene:3,Neutral:4};(0,c.useEffect)(function(){a&&fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/mood"),{headers:{Authorization:"Bearer ".concat(a.id)}}).then(function(t){return t.json()}).then(function(t){return y({mood:t.mood,intensity:t.intensity})})},[a]);for(var O=[{mood:h.mood,intensity:h.intensity,offset:0}],B=new Float32Array(150),N=new Float32Array(150),F=0;F<50;F++){var E=F/50*Math.PI*2;B[3*F]=.5*Math.sin(E),B[3*F+1]=0,B[3*F+2]=.5*Math.cos(E),N[3*F]=(Math.random()-.5)*.02,N[3*F+1]=(Math.random()-.5)*.02,N[3*F+2]=(Math.random()-.5)*.02}var R=(0,m.useDrag)(function(t){var n=(0,r.A)(t.offset,2),e=n[0],o=(n[1],t.down);u.current&&o&&(u.current.rotation.y+=.005*e)});(0,v.F)(function(t){var n=t.clock.getElapsedTime();if(l.current.forEach(function(t,e){t&&(t.rotation.y+=.02+.01*h.intensity,t.rotation.x=.1*Math.sin(.5*n),t.scale.setScalar(1+.3*h.intensity*Math.sin(n*(2+h.intensity))))}),d.current){for(var e=d.current.geometry.attributes.position.array,o=d.current.geometry.attributes.velocity.array,r=0;r<50;r++){var i=r/50*Math.PI*2+.5*n,a=.5+.1*h.intensity,s=Math.sin(i)*a,c=Math.cos(i)*a;e[3*r]+=o[3*r]+(s-e[3*r])*.05,e[3*r+1]+=o[3*r+1]+(0-e[3*r+1])*.05,e[3*r+2]+=o[3*r+2]+(c-e[3*r+2])*.05}d.current.geometry.attributes.position.needsUpdate=!0}});var D=(n=(0,i.A)(s().mark(function t(n){return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/interactions"),{method:"POST",headers:{Authorization:"Bearer ".concat(a.id),"Content-Type":"application/json"},body:JSON.stringify({interaction_type:"mood_click",zodiac_sign:null,details:{mood:n}})});case 3:A(function(t){return j(j({},t),{},(0,o.A)({},n,1))}),setTimeout(function(){return A(function(t){return j(j({},t),{},(0,o.A)({},n,0))})},1500),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to log mood interaction");case 10:case"end":return t.stop()}},t,null,[[0,7]])})),function(t){return n.apply(this,arguments)});return(0,w.jsxs)("group",j(j({position:e,ref:u},R()),{},{children:[O.map(function(t,n){var e,o,r,i;return(0,w.jsxs)("group",{children:[(0,w.jsxs)("mesh",{position:[0,.2*n,0],ref:function(t){return l.current[n]=t},onPointerOver:function(){return z(t.mood)},onPointerOut:function(){return z(null)},onClick:function(){return D(t.mood)},children:[(0,w.jsx)("torusGeometry",{args:[.5,.02,16,32]}),(0,w.jsx)(C,{baseColor:(null==(e=M[t.mood])?void 0:e.base)||new x.Color("#ffffff"),secondaryColor:(null==(o=M[t.mood])?void 0:o.secondary)||new x.Color("#cccccc"),strength:t.intensity,zodiacType:k[t.mood]||4,tarotBurst:0,transitBurst:0,glowBurst:T[t.mood]||0,moodIntensity:t.intensity,time:Date.now()/1e3})]}),(0,w.jsxs)("points",{ref:d,children:[(0,w.jsxs)("bufferGeometry",{children:[(0,w.jsx)("bufferAttribute",{attach:"attributes-position",array:B,count:50,itemSize:3}),(0,w.jsx)("bufferAttribute",{attach:"attributes-velocity",array:N,count:50,itemSize:3})]}),(0,w.jsx)(P,{color:(null==(r=M[t.mood])?void 0:r.base)||new x.Color("#ffffff"),moodType:k[t.mood]||4,time:Date.now()/1e3})]}),b===t.mood&&(0,w.jsx)(f.E,{position:[0,.2*n+.15,0],fontSize:.1,material:new _({color:(null==(i=M[t.mood])?void 0:i.base)||new x.Color("#ffffff"),opacity:.8,time:Date.now()/1e3}),children:"Mood: ".concat(t.mood," (").concat(t.intensity.toFixed(2),")")})]},t.mood)}),(0,w.jsx)(f.E,{position:[0,-.5,0],fontSize:.2,color:"white",onClick:function(){return fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/mood"),{headers:{Authorization:"Bearer ".concat(a.id)}}).then(function(t){return t.json()}).then(function(t){return y({mood:t.mood,intensity:t.intensity})})},children:"Refresh Mood"})]}))}function N(){var t,n=(0,u.A)().user,e=(0,c.useState)("default"),o=e[0],r=e[1],a=(t=(0,i.A)(s().mark(function t(e){return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/preferences"),{method:"POST",headers:{Authorization:"Bearer ".concat(null==n?void 0:n.id),"Content-Type":"application/json"},body:JSON.stringify({ar_filter:(null==n?void 0:n.zodiacSign.toLowerCase())+"_filter",sound_enabled:!0,aura_style:e})});case 3:r(e),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Failed to update aura style");case 9:case"end":return t.stop()}},t,null,[[0,6]])})),function(n){return t.apply(this,arguments)});return(0,w.jsxs)("div",{className:"h-screen w-full bg-black relative",children:[(0,w.jsxs)(h.Hl,{camera:{position:[0,0,15]},children:[(0,w.jsx)("ambientLight",{intensity:.4}),(0,w.jsx)("pointLight",{position:[10,10,10],intensity:1}),(0,w.jsx)(T,{}),(0,w.jsx)(A,{}),(0,w.jsx)(M,{position:[-3,2,0],text:"Home",href:"/home",zodiac:"Aries",size:.8,color:"#ff4500"}),(0,w.jsx)(M,{position:[0,2,0],text:"Profile",href:"/profile",zodiac:"Leo",size:.4,color:"#ffd700",isMoon:!0}),(0,w.jsx)(k,{position:[-1.5,2.5,0],user:n}),(0,w.jsx)(O,{position:[1.5,2.5,0],user:n}),(0,w.jsx)(B,{position:[-1.5,2.5,0],user:n}),(0,w.jsx)(M,{position:[3,2,0],text:"Feed",href:"/feed",zodiac:"Virgo",size:.6,color:"#00ff7f"}),(0,w.jsx)(M,{position:[0,-1,0],text:"Community",href:"/community",zodiac:"Libra",size:.5,color:"#1e90ff"}),(0,w.jsx)(p.N,{enableZoom:!0,enablePan:!0})]}),n&&(0,w.jsxs)("div",{className:"absolute top-4 left-4 text-white z-10 bg-black/50 p-4 rounded-lg",children:[(0,w.jsxs)("h2",{className:"text-xl font-bold",children:["Star Navigator: ",n.email]}),(0,w.jsxs)("p",{children:["Zodiac: ",n.zodiacSign]}),(0,w.jsxs)("select",{value:o,onChange:function(t){return a(t.target.value)},className:"mt-2 bg-gray-800 text-white p-2 rounded text-sm","aria-label":"Select aura style",children:[(0,w.jsx)("option",{value:"default",children:"Default Aura"}),(0,w.jsx)("option",{value:"fiery",children:"Fiery Ripples (Aries)"}),(0,w.jsx)("option",{value:"swirly",children:"Golden Swirls (Leo)"}),(0,w.jsx)("option",{value:"pulsing",children:"Verdant Pulse (Virgo)"}),(0,w.jsx)("option",{value:"wavy",children:"Harmonic Waves (Libra)"})]})]})]})}(0,v.e)(x),(0,v.e)({DistortionAuraMaterial:z,DNANodeMaterial:C,HolographicLabelMaterial:_,HelixTrailMaterial:S,ParticleTrailMaterial:P})},1320:(t,n,e)=>{e.d(n,{A:()=>i});var o=e(4232);e(7876);var r=(0,o.createContext)({user:null,loading:!0,login:function(){},logout:function(){}}),i=function(){return(0,o.useContext)(r)}}}]);