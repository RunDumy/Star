(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2228],{4508:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/matchmaking",function(){return n(7196)}])},5251:(e,t,n)=>{"use strict";n.d(t,{ND:()=>r}),n(3081);var r=(0,n(4577).UU)("https://dummy.supabase.co","dummy_key")},7196:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(3857),s=n(3081),a=n.n(s),i=n(5784),c=n(6848),o=n(4232),u=n(8982),l=n(4e3),p=n(5251),d=n(7876);function h(e){var t=e.children,n=(0,l.useRouter)(),s=(0,o.useState)(!0),i=s[0],c=s[1];return((0,o.useEffect)(function(){var e=!0;return(0,r.A)(a().mark(function t(){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.ND.auth.getUser();case 3:!t.sent.data.user&&e&&n.push("/login"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n.push("/login");case 11:return t.prev=11,e&&c(!1),t.finish(11);case 14:case"end":return t.stop()}},t,null,[[0,8,11,14]])}))(),function(){e=!1}},[n]),i)?(0,d.jsx)("div",{className:"p-6",children:"Checking authentication..."}):(0,d.jsx)(d.Fragment,{children:t})}var x=function(e){var t=e.cardName;return(0,d.jsx)("div",{style:{width:"200px",height:"300px",background:"#4B0082",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:t})};function f(){var e,t=(0,o.useState)([]),n=t[0],s=t[1],l=(0,o.useState)({sent:[],received:[]}),p=l[0],h=l[1],f=(0,o.useState)(!1),m=f[0],g=f[1],y=(0,o.useState)(""),v=y[0],b=y[1],j=(0,o.useState)("suggestions"),N=j[0],w=j[1],k=(0,o.useState)(!1),_=k[0],C=k[1],S=(0,o.useState)(null),O=S[0],A=S[1],F=(0,o.useState)(null),P=F[0],H=F[1],z=(0,o.useState)(!1),T=z[0],D=z[1],E=(0,o.useState)(null),R=E[0],q=E[1],U=(0,o.useCallback)((0,r.A)(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,t=v?"?zodiac=".concat(encodeURIComponent(v)):"",e.next=5,u.FH.get("/api/v1/matchmaking/suggestions"+t);case 5:s(e.sent.data.suggestions||[]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Failed to load suggestions",e.t0);case 12:return e.prev=12,g(!1),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,9,12,15]])})),[v]);function I(){return(I=(0,r.A)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.FH.get("/api/v1/mood");case 3:q(e.sent.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load user mood",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function J(){return L.apply(this,arguments)}function L(){return(L=(0,r.A)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.FH.get("/api/v1/matchmaking/connections");case 3:h(e.sent.data||{sent:[],received:[]}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load connections",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function M(e,t){return B.apply(this,arguments)}function B(){return(B=(0,r.A)(a().mark(function e(t,n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.FH.post("/api/v1/matchmaking/connection",{action:t,connection_id:n});case 3:C(!1),A(null),J(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to respond to connection",e.t0),alert("Failed to respond to connection");case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function G(){return(G=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.FH.post("/api/v1/matchmaking/connection",{target_id:t});case 3:alert(e.sent.data.message||"Request sent"),J(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to send request",e.t0),alert("Failed to send request");case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function Y(){return(Y=(0,r.A)(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.FH.post("/api/v1/matchmaking/connection",{target_id:t,action:"request"});case 3:return e.next=5,u.FH.get("/api/v1/matchmaking/connections");case 5:if(!(n=(e.sent.data.sent||[]).find(function(e){return e.other_id===t}))){e.next=11;break}return e.next=11,u.FH.post("/api/v1/matchmaking/connection",{action:"reject",connection_id:n.id});case 11:J(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Failed to reject suggestion",e.t0);case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}(0,o.useEffect)(function(){U(),J(),function(){I.apply(this,arguments)}()},[U]);var X=(e=(0,r.A)(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,u.FH.post("/api/v1/tarot/pull");case 4:(t=e.sent).data.success?(H(t.data.card),D(!0),U()):alert(t.data.error||"Failed to draw a cosmic card"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Unable to connect to the cosmos",e.t0),alert("Unable to connect to the cosmos");case 12:return e.prev=12,g(!1),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,8,12,15]])})),function(){return e.apply(this,arguments)});return(0,d.jsxs)("div",{className:"p-8",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Matchmaking"}),R&&(0,d.jsxs)("div",{className:"mb-4 p-4 bg-gray-800 rounded-lg",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold",children:"Your Current Mood"}),(0,d.jsxs)("p",{className:"text-gray-300",children:["Mood: ",R.mood," (Intensity: ",R.intensity.toFixed(2),")"]})]}),(0,d.jsxs)("div",{className:"mb-6 flex gap-2",children:[(0,d.jsx)("button",{onClick:function(){return w("suggestions")},className:"px-3 py-2 rounded ".concat("suggestions"===N?"bg-purple-600":"bg-gray-700"),children:"Suggestions"}),(0,d.jsx)("button",{onClick:function(){return w("connections")},className:"px-3 py-2 rounded ".concat("connections"===N?"bg-purple-600":"bg-gray-700"),children:"Connections"}),(0,d.jsx)("button",{onClick:function(){return w("horoscopes")},className:"px-3 py-2 rounded ".concat("horoscopes"===N?"bg-purple-600":"bg-gray-700"),children:"Horoscopes"})]}),(0,d.jsxs)(i.N,{mode:"wait",children:["suggestions"===N&&(0,d.jsxs)(c.P.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},children:[(0,d.jsx)("h2",{className:"text-xl font-semibold",children:"Suggestions"}),(0,d.jsxs)("div",{className:"mt-2 flex items-center gap-3",children:[(0,d.jsx)("label",{htmlFor:"zodiac-filter",className:"text-sm",children:"Filter by zodiac:"}),(0,d.jsxs)("select",{id:"zodiac-filter",value:v,onChange:function(e){return b(e.target.value)},className:"bg-gray-700 p-2 rounded text-sm",children:[(0,d.jsx)("option",{value:"",children:"All"}),["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces"].map(function(e){return(0,d.jsx)("option",{value:e,children:e},e)})]}),(0,d.jsx)("button",{className:"ml-2 px-3 py-1 bg-indigo-600 rounded",onClick:function(){return U()},children:"Apply"})]}),(0,d.jsx)("div",{className:"mt-4 flex justify-center",children:(0,d.jsx)("button",{onClick:X,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-all duration-300",disabled:m,children:m?"Drawing...":"Draw Your Cosmic Card"})}),m&&(0,d.jsx)("p",{children:"Loading..."}),(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:n.map(function(e){return(0,d.jsxs)(c.P.div,{layout:!0,className:"p-4 rounded bg-gray-800",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-white font-medium",children:e.username}),(0,d.jsx)("div",{className:"text-gray-400 text-sm",children:e.zodiac_sign})]}),(0,d.jsx)("div",{className:"text-sm text-yellow-300",children:e.compatibility_score?"".concat(e.compatibility_score,"%"):"—"})]}),e.bio&&(0,d.jsx)("div",{className:"text-gray-300 text-sm mt-2",children:e.bio}),(0,d.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,d.jsx)("button",{className:"px-3 py-1 bg-indigo-600 rounded",onClick:function(){return function(e){return G.apply(this,arguments)}(e.id)},disabled:e.has_connection,children:"Connect"}),(0,d.jsx)("button",{className:"px-3 py-1 bg-red-600 rounded",onClick:function(){return function(e){return Y.apply(this,arguments)}(e.id)},children:"Reject"})]})]},e.id)})})]},"suggestions"),"connections"===N&&(0,d.jsxs)(c.P.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},children:[(0,d.jsx)("h2",{className:"text-xl font-semibold",children:"Connections"}),(0,d.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg",children:"Sent"}),(0,d.jsx)("ul",{children:p.sent.map(function(e){return(0,d.jsxs)("li",{className:"py-2 border-b border-gray-700",children:[e.other_username," — ",e.status]},e.id)})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg",children:"Received"}),(0,d.jsx)("ul",{children:p.received.map(function(e){return(0,d.jsxs)("li",{className:"py-2 border-b border-gray-700 flex justify-between items-center",children:[(0,d.jsxs)("div",{children:[e.other_username," — ",e.status]}),"pending"===e.status&&(0,d.jsx)("div",{className:"flex gap-2",children:(0,d.jsx)("button",{onClick:function(){A(e),C(!0)},className:"px-3 py-1 bg-green-600 rounded",children:"Respond"})})]},e.id)})})]})]})]},"connections"),"horoscopes"===N&&(0,d.jsxs)(c.P.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},children:[(0,d.jsx)("h2",{className:"text-xl font-semibold",children:"Pair Horoscopes"}),(0,d.jsx)("div",{className:"mt-4 text-gray-300",children:"When two connections are accepted their pair horoscope appears here. (Coming soon)"})]},"horoscopes")]}),(0,d.jsx)(i.N,{children:_&&O&&(0,d.jsx)(c.P.div,{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,d.jsxs)(c.P.div,{className:"bg-navy-900 p-6 rounded-lg w-11/12 max-w-md",initial:{scale:.95},animate:{scale:1},exit:{scale:.95},children:[(0,d.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Connection Request"}),(0,d.jsxs)("p",{className:"text-gray-300 mb-4",children:[O.other_username," has sent you a connection request."]}),(0,d.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,d.jsx)("button",{onClick:function(){M("reject",O.id)},className:"px-3 py-2 bg-red-600 rounded",children:"Reject"}),(0,d.jsx)("button",{onClick:function(){M("accept",O.id)},className:"px-3 py-2 bg-green-600 rounded",children:"Accept"})]})]})})}),T&&P&&(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg max-w-md w-full mx-4",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-center mb-4",children:"Your Cosmic Guidance"}),(0,d.jsx)("div",{className:"flex justify-center mb-4",children:(0,d.jsx)(x,{cardName:P.card_name})}),(0,d.jsx)("h3",{className:"text-xl font-semibold mb-2",children:P.card_name}),(0,d.jsx)("p",{className:"text-gray-700 mb-4",children:P.interpretation}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("button",{onClick:function(){return D(!1)},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Close"}),(0,d.jsx)("button",{onClick:function(){var e,t;null==(e=(t=navigator).share)||e.call(t,{title:"My Cosmic Card: ".concat(P.card_name),text:P.interpretation})},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Share"})]})]})})]})}function m(){return(0,d.jsx)(h,{children:(0,d.jsx)(f,{})})}function g(){return(0,d.jsx)(m,{})}},8982:(e,t,n)=>{"use strict";n.d(t,{FH:()=>d,aS:()=>j,d$:()=>v,JB:()=>f,U4:()=>_,pG:()=>S,iD:()=>h,jc:()=>w,tt:()=>g});var r=n(3857),s=n(3081),a=n.n(s),i=n(1040),c=n(2969);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){(0,c.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e){var t=u({},e);if("string"==typeof t.user_id){var n=parseInt(t.user_id,10);Number.isNaN(n)||(t.user_id=n)}return t}var p="https://star-backend.azurewebsites.net".replace(/\/$/,""),d=i.A.create({baseURL:p});function h(e){return x.apply(this,arguments)}function x(){return(x=(0,r.A)(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.post("/api/v1/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.get("/api/v1/zodiac-numbers");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=(0,r.A)(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.post("/api/v1/upload",t,{headers:{"Content-Type":"multipart/form-data"}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(){return b.apply(this,arguments)}function b(){return(b=(0,r.A)(a().mark(function e(){var t,n,r,s,i=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:1,n=i.length>1?i[1]:void 0,r={page:t},void 0!==n&&(r.user_id=n),e.next=6,d.get("/api/v1/feed",{params:r});case 6:return s=e.sent,e.abrupt("return",s.data);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(e){return N.apply(this,arguments)}function N(){return(N=(0,r.A)(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.post("/api/v1/archetype-oracle/calculate",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(e,t,n){return k.apply(this,arguments)}function k(){return(k=(0,r.A)(a().mark(function e(t,n,r){var s,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof fetch){e.next=5;break}return e.next=3,fetch("/api/v1/tarot/share-spread",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({spread:t,spread_type:n,user_id:r})});case 3:return s=e.sent,e.abrupt("return",s.json());case 5:return e.next=7,d.post("/api/v1/tarot/share-spread",{spread:t,spread_type:n,user_id:r});case 7:return i=e.sent,e.abrupt("return",i.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e,t){return C.apply(this,arguments)}function C(){return(C=(0,r.A)(a().mark(function e(t,n){var r,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof fetch){e.next=5;break}return e.next=3,fetch("/api/v1/tarot/spotify-playlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({energy_flows:t,spread_type:n})});case 3:return r=e.sent,e.abrupt("return",r.json());case 5:return e.next=7,d.post("/api/v1/tarot/spotify-playlist",{energy_flows:t,spread_type:n});case 7:return s=e.sent,e.abrupt("return",s.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){return O.apply(this,arguments)}function O(){return(O=(0,r.A)(a().mark(function e(t){var n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof fetch){e.next=5;break}return e.next=3,fetch("/api/v1/tarot/location-insights",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip_address:t})});case 3:return n=e.sent,e.abrupt("return",n.json());case 5:return e.next=7,d.post("/api/v1/tarot/location-insights",{ip_address:t});case 7:return r=e.sent,e.abrupt("return",r.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}d.interceptors.request.use(function(e){var t=localStorage.getItem("token");return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),e}),d.interceptors.response.use(function(e){var t,n;return null!=(t=e.config.url)&&t.includes("/api/v1/feed")&&(e.data=u(u({},n=e.data),{},{items:n.items.map(l)})),e})}},e=>{e.O(0,[2909,1040,6958,6848,4916,636,6593,8792],()=>e(e.s=4508)),_N_E=e.O()}]);