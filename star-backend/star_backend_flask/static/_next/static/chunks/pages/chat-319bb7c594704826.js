(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9106],{1378:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(7876),r=a(6848),i=a(5784),l=a(8650),n=a(1404),o=a(441),c=a(6063),d=a(3381),m=a(8113),p=a(6293),u=a(4232),x=a(4614);let h={fire:l.A,earth:n.A,air:o.A,water:c.A},g={aries:"♈",taurus:"♉",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpio:"♏",sagittarius:"♐",capricorn:"♑",aquarius:"♒",pisces:"♓"};function f(){var e,t,a;let[l,n]=(0,u.useState)([]),[o,c]=(0,u.useState)(null),[f,y]=(0,u.useState)([]),[b,v]=(0,u.useState)([]),[j,N]=(0,u.useState)(""),[w,_]=(0,u.useState)(!1),[S,C]=(0,u.useState)(!1),k=(0,u.useRef)(null);(0,u.useEffect)(()=>{T()},[]),(0,u.useEffect)(()=>{o&&(A(o),z(o))},[o]),(0,u.useEffect)(()=>{P()},[f]);let T=async()=>{try{let e=await x.FH.get("/api/v1/zodiac-rooms");n(e.data.rooms);let t=e.data.rooms.find(e=>e.is_user_element);t&&c(t.id)}catch(e){console.error("Failed to fetch zodiac rooms:",e)}},A=async e=>{_(!0);try{let t=await x.FH.get("/api/v1/zodiac-rooms/".concat(e,"/messages"));y(t.data.messages)}catch(e){console.error("Failed to fetch messages:",e)}finally{_(!1)}},z=async e=>{try{let t=await x.FH.get("/api/v1/zodiac-rooms/".concat(e,"/members"));v(t.data.members)}catch(e){console.error("Failed to fetch members:",e)}},E=async()=>{if(j.trim()&&o&&!S){C(!0);try{await x.FH.post("/api/v1/zodiac-rooms/".concat(o,"/messages"),{content:j.trim()}),N(""),A(o)}catch(e){console.error("Failed to send message:",e)}finally{C(!1)}}},P=()=>{var e;null==(e=k.current)||e.scrollIntoView({behavior:"smooth"})},F=e=>g[e.toLowerCase()]||"⭐";return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)(r.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-white mb-4 flex items-center justify-center gap-3",children:[(0,s.jsx)(d.A,{className:"w-10 h-10 text-purple-400"}),"Zodiac Chat Rooms"]}),(0,s.jsx)("p",{className:"text-gray-300 text-lg",children:"Connect with souls of your elemental tribe"})]}),(0,s.jsxs)("div",{className:"grid lg:grid-cols-4 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-gray-800/50 backdrop-blur-lg rounded-lg p-6 border border-purple-500/20",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Elemental Tribes"}),(0,s.jsx)("div",{className:"space-y-3",children:l.map(e=>{let t=h[e.id];return(0,s.jsxs)(r.P.button,{onClick:()=>c(e.id),className:"w-full p-4 rounded-lg border-2 transition-all ".concat(o===e.id?"border-yellow-400 bg-yellow-900/30":"border-gray-600 hover:border-yellow-300"," ").concat(e.is_user_element?"ring-2 ring-purple-400/50":""),whileHover:{scale:1.02},whileTap:{scale:.98},style:{borderColor:o===e.id?e.color:void 0},children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)(t,{className:"w-6 h-6",style:{color:e.color}}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"text-white font-medium",children:e.name}),e.is_user_element&&(0,s.jsx)("div",{className:"text-xs text-purple-300",children:"Your Tribe"})]})]}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"text-gray-300 text-sm mb-1",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[(0,s.jsxs)("span",{children:[e.online_count," online"]}),(0,s.jsxs)("span",{children:[e.recent_activity," active"]})]})]})]},e.id)})})]})}),(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsx)(i.N,{mode:"wait",children:o?(0,s.jsxs)(r.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"bg-gray-800/50 backdrop-blur-lg rounded-lg border border-purple-500/20 h-[600px] flex flex-col",children:[l.find(e=>e.id===o)&&(0,s.jsx)("div",{className:"p-4 border-b border-gray-700 rounded-t-lg ".concat((e=>{switch(e){case"fire":return"bg-red-900/20";case"earth":return"bg-green-900/20";case"air":return"bg-blue-900/20";case"water":return"bg-purple-900/20";default:return"bg-gray-800/20"}})(o||"")),children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[u.createElement(h[o],{className:"w-6 h-6",style:{color:null==(e=l.find(e=>e.id===o))?void 0:e.color}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-white font-semibold",children:null==(t=l.find(e=>e.id===o))?void 0:t.name}),(0,s.jsx)("p",{className:"text-gray-300 text-sm",children:null==(a=l.find(e=>e.id===o))?void 0:a.signs.map(e=>"".concat(F(e)," ").concat(e.charAt(0).toUpperCase()+e.slice(1))).join(", ")})]})]})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[w?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Loading cosmic conversations..."})]}):0===f.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-12 h-12 text-gray-500 mx-auto mb-4",children:"⭐"}),(0,s.jsx)("p",{className:"text-gray-400",children:"No messages yet. Be the first to share your cosmic wisdom!"})]}):f.map(e=>{var t,a,i,l;return(0,s.jsxs)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-semibold",children:(null==(a=e.profiles)||null==(t=a.username)?void 0:t.charAt(0).toUpperCase())||"?"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"text-white font-medium",children:(null==(i=e.profiles)?void 0:i.username)||"Unknown"}),(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:F((null==(l=e.profiles)?void 0:l.zodiac_sign)||"")}),(0,s.jsx)("span",{className:"text-gray-500 text-xs",children:new Date(e.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsx)("p",{className:"text-gray-300 leading-relaxed",children:e.content})]})]},e.id)}),(0,s.jsx)("div",{ref:k})]}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:j,onChange:e=>N(e.target.value),onKeyDown:e=>{"Enter"===e.key&&E()},placeholder:"Share your cosmic thoughts...",className:"flex-1 px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500",disabled:S}),(0,s.jsxs)("button",{onClick:E,disabled:!j.trim()||S,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors flex items-center gap-2",children:[S?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,s.jsx)(m.A,{className:"w-4 h-4"}),"Send"]})]})})]},o):(0,s.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-gray-800/50 backdrop-blur-lg rounded-lg border border-purple-500/20 h-[600px] flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.A,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Select Your Tribe"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Choose an elemental chat room to join the cosmic conversation"})]})})})}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-gray-800/50 backdrop-blur-lg rounded-lg p-6 border border-purple-500/20",children:[(0,s.jsxs)("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[(0,s.jsx)(p.A,{className:"w-5 h-5"}),"Tribe Members"]}),(0,s.jsxs)("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:[b.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-700/50",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.is_online?"bg-green-400":"bg-gray-500")}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-white font-medium text-sm",children:e.username}),(0,s.jsxs)("div",{className:"text-gray-400 text-xs flex items-center gap-1",children:[F(e.zodiac_sign),e.zodiac_sign.charAt(0).toUpperCase()+e.zodiac_sign.slice(1)]})]})]},e.id)),0===b.length&&(0,s.jsx)("p",{className:"text-gray-400 text-sm text-center py-4",children:"No members online"})]})]})})]})]})})}function y(){return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Chat"}),(0,s.jsx)(f,{})]})}},4480:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return a(1378)}])},4614:(e,t,a)=>{"use strict";a.d(t,{FH:()=>l,aS:()=>m,d$:()=>d,JB:()=>o,U4:()=>u,pG:()=>x,iD:()=>n,jc:()=>p,tt:()=>c});var s=a(1040);function r(e){let t={...e};if("string"==typeof t.user_id){let e=parseInt(t.user_id,10);Number.isNaN(e)||(t.user_id=e)}return t}let i="https://star-backend.azurewebsites.net".replace(/\/$/,""),l=s.A.create({baseURL:i});async function n(e){return(await l.post("/api/v1/login",e)).data}async function o(){return(await l.get("/api/v1/zodiac-numbers")).data}async function c(e){return(await l.post("/api/v1/upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,a={page:e};return void 0!==t&&(a.user_id=t),(await l.get("/api/v1/feed",{params:a})).data}async function m(e){return(await l.post("/api/v1/archetype-oracle/calculate",e)).data}async function p(e,t,a){return"undefined"!=typeof fetch?(await fetch("/api/v1/tarot/share-spread",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({spread:e,spread_type:t,user_id:a})})).json():(await l.post("/api/v1/tarot/share-spread",{spread:e,spread_type:t,user_id:a})).data}async function u(e,t){return"undefined"!=typeof fetch?(await fetch("/api/v1/tarot/spotify-playlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({energy_flows:e,spread_type:t})})).json():(await l.post("/api/v1/tarot/spotify-playlist",{energy_flows:e,spread_type:t})).data}async function x(e){return"undefined"!=typeof fetch?(await fetch("/api/v1/tarot/location-insights",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip_address:e})})).json():(await l.post("/api/v1/tarot/location-insights",{ip_address:e})).data}l.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t))}return e}),l.interceptors.response.use(e=>{var t;return(null==(t=e.config.url)?void 0:t.includes("/api/v1/feed"))&&(e.data=function(e){return{...e,items:e.items.map(r)}}(e.data)),e})}},e=>{e.O(0,[2909,1040,6848,679,636,6593,8792],()=>e(e.s=4480)),_N_E=e.O()}]);