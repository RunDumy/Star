"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6698],{6698:(e,t,r)=>{r.r(t),r.d(t,{NotificationPanel:()=>b});var n=r(2969),a=r(236),o=r(3857),s=r(3081),i=r.n(s),c=r(7534),u=r(5361),l=r(4232),f=r(4301);r(3754);var p=r(7876);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){(0,n.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(){var e,t=(0,l.useState)([]),r=t[0],n=t[1],s=(0,c.T)(),d=s.socket,b=s.currentUser;(0,l.useEffect)(function(){var e;return(e=(0,o.A)(i().mark(function e(){var t,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.N.auth.getSession();case 2:if(t=e.sent.data.session){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,fetch("".concat("http://localhost:5000","/api/v1/notifications"),{headers:{Authorization:"Bearer ".concat(t.access_token)}});case 8:if(!(r=e.sent).ok){e.next=15;break}return e.next=12,r.json();case 12:n(e.sent.notifications);case 15:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})(),d.emit("join_notifications",{user_id:null==b?void 0:b.id}),d.on("notification",function(e){n(function(t){return[e].concat((0,a.A)(t))}),f.oR.info(e.message,{position:"top-right",autoClose:5e3,theme:"dark",className:"bg-gradient-to-br from-purple-900/50 to-blue-900/50 border border-purple-500/30"})}),function(){return d.off("notification")}},[d,b]);var m=(e=(0,o.A)(i().mark(function e(t){var r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.N.auth.getSession();case 2:if(r=e.sent.data.session){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,fetch("".concat("http://localhost:5000","/api/v1/notifications/").concat(t,"/read"),{method:"POST",headers:{Authorization:"Bearer ".concat(r.access_token)}});case 8:n(function(e){return e.map(function(e){return e.id===t?h(h({},e),{},{is_read:!0}):e})});case 9:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)});return(0,p.jsxs)("div",{className:"fixed top-4 right-4 max-w-xs w-full bg-gradient-to-br from-purple-900/50 to-blue-900/50 border border-purple-500/30 rounded-lg p-4 text-white shadow-2xl cosmic-glow z-50",children:[(0,p.jsx)("h4",{className:"font-semibold mb-4 text-cyan-200",children:"\uD83C\uDF1F Cosmic Notifications"}),(0,p.jsxs)("div",{className:"space-y-2 max-h-[50vh] overflow-y-auto",children:[0===r.length&&(0,p.jsx)("div",{className:"text-gray-400 text-sm",children:"No new cosmic messages..."}),r.map(function(e){return(0,p.jsxs)("button",{className:"w-full text-left p-2 rounded-lg transition-all duration-300 hover:scale-105 ".concat(e.is_read?"bg-gray-700/50":"bg-purple-500/30"),onClick:function(){return!e.is_read&&m(e.id)},disabled:e.is_read,children:[(0,p.jsx)("div",{className:"text-sm",children:e.message}),(0,p.jsx)("div",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleTimeString()})]},e.id)})]}),(0,p.jsx)(f.N9,{})]})}}}]);