"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3542],{3542:(e,a,t)=>{t.r(a),t.d(a,{AgoraUIKitLiveStream:()=>o});var s=t(7876),l=t(4563),r=t(4510),n=t(4141),c=t(4232),i=t(5364);function o(e){let{streamId:a,isHost:t=!1}=e,[o,d]=(0,c.useState)(null),[u,h]=(0,c.useState)(!0),[m,x]=(0,c.useState)(null),{socket:f,currentUser:g}=(0,l.T)();if((0,c.useEffect)(()=>{(async()=>{try{let{data:{session:e}}=await r.ND.auth.getSession();if(!e){x("Please log in to view live streams"),h(!1);return}let t=await fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/live-stream/").concat(a),{headers:{Authorization:"Bearer ".concat(e.access_token)}});if(t.ok){let{stream:e}=await t.json();d(e)}else x("Stream not found or inactive")}catch(e){x("Failed to load stream"),console.error("Error fetching stream:",e)}finally{h(!1)}})()},[a]),(0,c.useEffect)(()=>{f&&o&&f.emit("join_stream",{streamId:o.id})},[f,o]),u)return(0,s.jsx)("div",{className:"flex items-center justify-center h-64 bg-black/50 rounded-lg",children:(0,s.jsx)("div",{className:"text-white",children:"Loading stream..."})});if(m||!o)return(0,s.jsx)("div",{className:"flex items-center justify-center h-64 bg-black/50 rounded-lg",children:(0,s.jsx)("div",{className:"text-red-400",children:m||"Stream not available"})});let b={appId:i.env.NEXT_PUBLIC_AGORA_APP_ID,channel:o.channel_name,token:o.agora_token};return(0,s.jsxs)("div",{className:"w-full h-full bg-black rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 bg-gradient-to-r from-purple-900 to-blue-900",children:[(0,s.jsx)("h2",{className:"text-white text-xl font-bold",children:o.title}),(0,s.jsxs)("p",{className:"text-gray-300",children:["Hosted by ",o.username," (",o.zodiac_sign,")"]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.Ay,{rtcProps:b,callbacks:{EndCall:async()=>{if(t){let{data:{session:e}}=await r.ND.auth.getSession();e&&await fetch("".concat("https://star-backend.azurewebsites.net","/api/v1/live-stream/").concat(a,"/end"),{method:"POST",headers:{Authorization:"Bearer ".concat(e.access_token)}})}console.log("Call ended")}},styleProps:{UIKitContainer:{height:"600px",width:"100%"},localBtnContainer:{backgroundColor:"#1a1a1a"},localBtnStyles:{muteLocalAudio:{backgroundColor:"#4a5568"},muteLocalVideo:{backgroundColor:"#4a5568"},switchCamera:{backgroundColor:"#4a5568"},endCall:{backgroundColor:"#e53e3e"}}}}),(0,s.jsxs)("div",{className:"absolute top-4 left-4 bg-black/70 text-white p-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"LIVE"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-300 mt-1",children:"Cosmic Stream"})]})]})]})}}}]);