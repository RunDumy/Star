(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9106],{3530:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var n=r(3857),s=r(3081),a=r.n(s),i=r(6848),c=r(5784),o=r(7679),l=r(6451),u=r(954),d=r(5874),p=r(4554),x=r(3642),m=r(7284),f=r(4232),h=r(8982),b=r(7876),g={fire:o.A,earth:l.A,air:u.A,water:d.A},v={aries:"♈",taurus:"♉",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpio:"♏",sagittarius:"♐",capricorn:"♑",aquarius:"♒",pisces:"♓"};function y(){var e,t,r,s,o,l,u,d=(0,f.useState)([]),y=d[0],j=d[1],w=(0,f.useState)(null),N=w[0],k=w[1],_=(0,f.useState)([]),A=_[0],O=_[1],S=(0,f.useState)([]),C=S[0],P=S[1],T=(0,f.useState)(""),z=T[0],E=T[1],F=(0,f.useState)(!1),D=F[0],U=F[1],H=(0,f.useState)(!1),J=H[0],L=H[1],B=(0,f.useRef)(null);(0,f.useEffect)(function(){I()},[]),(0,f.useEffect)(function(){N&&(R(N),q(N))},[N]),(0,f.useEffect)(function(){Y()},[A]);var I=(e=(0,n.A)(a().mark(function e(){var t,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.FH.get("/api/v1/zodiac-rooms");case 3:j((t=e.sent).data.rooms),(r=t.data.rooms.find(function(e){return e.is_user_element}))&&k(r.id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to fetch zodiac rooms:",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])})),function(){return e.apply(this,arguments)}),R=(t=(0,n.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return U(!0),e.prev=1,e.next=4,h.FH.get("/api/v1/zodiac-rooms/".concat(t,"/messages"));case 4:O(e.sent.data.messages),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Failed to fetch messages:",e.t0);case 11:return e.prev=11,U(!1),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])})),function(e){return t.apply(this,arguments)}),q=(r=(0,n.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.FH.get("/api/v1/zodiac-rooms/".concat(t,"/members"));case 3:P(e.sent.data.members),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to fetch members:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(e){return r.apply(this,arguments)}),X=(s=(0,n.A)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!z.trim()||!N||J)){e.next=2;break}return e.abrupt("return");case 2:return L(!0),e.prev=3,e.next=6,h.FH.post("/api/v1/zodiac-rooms/".concat(N,"/messages"),{content:z.trim()});case 6:E(""),R(N),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Failed to send message:",e.t0);case 13:return e.prev=13,L(!1),e.finish(13);case 16:case"end":return e.stop()}},e,null,[[3,10,13,16]])})),function(){return s.apply(this,arguments)}),Y=function(){var e;null==(e=B.current)||e.scrollIntoView({behavior:"smooth"})},$=function(e){return v[e.toLowerCase()]||"⭐"};return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)(i.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,b.jsxs)("h1",{className:"text-4xl font-bold text-white mb-4 flex items-center justify-center gap-3",children:[(0,b.jsx)(p.A,{className:"w-10 h-10 text-purple-400"}),"Zodiac Chat Rooms"]}),(0,b.jsx)("p",{className:"text-gray-300 text-lg",children:"Connect with souls of your elemental tribe"})]}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)("div",{className:"bg-gray-800/50 backdrop-blur-lg rounded-lg p-6 border border-purple-500/20",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Elemental Tribes"}),(0,b.jsx)("div",{className:"space-y-3",children:y.map(function(e){var t=g[e.id];return(0,b.jsxs)(i.P.button,{onClick:function(){return k(e.id)},className:"w-full p-4 rounded-lg border-2 transition-all ".concat(N===e.id?"border-yellow-400 bg-yellow-900/30":"border-gray-600 hover:border-yellow-300"," ").concat(e.is_user_element?"ring-2 ring-purple-400/50":""),whileHover:{scale:1.02},whileTap:{scale:.98},style:{borderColor:N===e.id?e.color:void 0},children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)(t,{className:"w-6 h-6",style:{color:e.color}}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"text-white font-medium",children:e.name}),e.is_user_element&&(0,b.jsx)("div",{className:"text-xs text-purple-300",children:"Your Tribe"})]})]}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"text-gray-300 text-sm mb-1",children:e.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[(0,b.jsxs)("span",{children:[e.online_count," online"]}),(0,b.jsxs)("span",{children:[e.recent_activity," active"]})]})]})]},e.id)})})]})}),(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsx)(c.N,{mode:"wait",children:N?(0,b.jsxs)(i.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"bg-gray-800/50 backdrop-blur-lg rounded-lg border border-purple-500/20 h-[600px] flex flex-col",children:[y.find(function(e){return e.id===N})&&(0,b.jsx)("div",{className:"p-4 border-b border-gray-700 rounded-t-lg ".concat(function(e){switch(e){case"fire":return"bg-red-900/20";case"earth":return"bg-green-900/20";case"air":return"bg-blue-900/20";case"water":return"bg-purple-900/20";default:return"bg-gray-800/20"}}(N||"")),children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[f.createElement(g[N],{className:"w-6 h-6",style:{color:null==(o=y.find(function(e){return e.id===N}))?void 0:o.color}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-white font-semibold",children:null==(l=y.find(function(e){return e.id===N}))?void 0:l.name}),(0,b.jsx)("p",{className:"text-gray-300 text-sm",children:null==(u=y.find(function(e){return e.id===N}))?void 0:u.signs.map(function(e){return"".concat($(e)," ").concat(e.charAt(0).toUpperCase()+e.slice(1))}).join(", ")})]})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[D?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Loading cosmic conversations..."})]}):0===A.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"w-12 h-12 text-gray-500 mx-auto mb-4",children:"⭐"}),(0,b.jsx)("p",{className:"text-gray-400",children:"No messages yet. Be the first to share your cosmic wisdom!"})]}):A.map(function(e){var t,r,n;return(0,b.jsxs)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-semibold",children:(null==(t=e.profiles)||null==(t=t.username)?void 0:t.charAt(0).toUpperCase())||"?"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"text-white font-medium",children:(null==(r=e.profiles)?void 0:r.username)||"Unknown"}),(0,b.jsx)("span",{className:"text-gray-400 text-sm",children:$((null==(n=e.profiles)?void 0:n.zodiac_sign)||"")}),(0,b.jsx)("span",{className:"text-gray-500 text-xs",children:new Date(e.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),(0,b.jsx)("p",{className:"text-gray-300 leading-relaxed",children:e.content})]})]},e.id)}),(0,b.jsx)("div",{ref:B})]}),(0,b.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:z,onChange:function(e){return E(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&X()},placeholder:"Share your cosmic thoughts...",className:"flex-1 px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-purple-500",disabled:J}),(0,b.jsxs)("button",{onClick:X,disabled:!z.trim()||J,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors flex items-center gap-2",children:[J?(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,b.jsx)(x.A,{className:"w-4 h-4"}),"Send"]})]})})]},N):(0,b.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-gray-800/50 backdrop-blur-lg rounded-lg border border-purple-500/20 h-[600px] flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(p.A,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Select Your Tribe"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Choose an elemental chat room to join the cosmic conversation"})]})})})}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)("div",{className:"bg-gray-800/50 backdrop-blur-lg rounded-lg p-6 border border-purple-500/20",children:[(0,b.jsxs)("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[(0,b.jsx)(m.A,{className:"w-5 h-5"}),"Tribe Members"]}),(0,b.jsxs)("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:[C.map(function(e){return(0,b.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-700/50",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.is_online?"bg-green-400":"bg-gray-500")}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white font-medium text-sm",children:e.username}),(0,b.jsxs)("div",{className:"text-gray-400 text-xs flex items-center gap-1",children:[$(e.zodiac_sign),e.zodiac_sign.charAt(0).toUpperCase()+e.zodiac_sign.slice(1)]})]})]},e.id)}),0===C.length&&(0,b.jsx)("p",{className:"text-gray-400 text-sm text-center py-4",children:"No members online"})]})]})})]})]})})}function j(){return(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Chat"}),(0,b.jsx)(y,{})]})}},4480:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return r(3530)}])},8982:(e,t,r)=>{"use strict";r.d(t,{FH:()=>p,aS:()=>N,d$:()=>j,JB:()=>b,U4:()=>O,pG:()=>C,iD:()=>x,kz:()=>f,jc:()=>_,tt:()=>v});var n=r(3857),s=r(3081),a=r.n(s),i=r(1040),c=r(2969);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){(0,c.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){var t=l({},e);if("string"==typeof t.user_id){var r=parseInt(t.user_id,10);Number.isNaN(r)||(t.user_id=r)}return t}var d="https://star-backend.azurewebsites.net".replace(/\/$/,""),p=i.A.create({baseURL:d});function x(e){return m.apply(this,arguments)}function m(){return(m=(0,n.A)(a().mark(function e(t){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.post("/api/v1/login",t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,n.A)(a().mark(function e(t){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.post("/api/v1/register",t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(){return g.apply(this,arguments)}function g(){return(g=(0,n.A)(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get("/api/v1/zodiac-numbers");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=(0,n.A)(a().mark(function e(t){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.post("/api/v1/upload",t,{headers:{"Content-Type":"multipart/form-data"}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(){return w.apply(this,arguments)}function w(){return(w=(0,n.A)(a().mark(function e(){var t,r,n,s,i=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:1,r=i.length>1?i[1]:void 0,n={page:t},void 0!==r&&(n.user_id=r),e.next=6,p.get("/api/v1/feed",{params:n});case 6:return s=e.sent,e.abrupt("return",s.data);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e){return k.apply(this,arguments)}function k(){return(k=(0,n.A)(a().mark(function e(t){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.post("/api/v1/archetype-oracle/calculate",t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e,t,r){return A.apply(this,arguments)}function A(){return(A=(0,n.A)(a().mark(function e(t,r,n){var s,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof fetch){e.next=5;break}return e.next=3,fetch("/api/v1/tarot/share-spread",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({spread:t,spread_type:r,user_id:n})});case 3:return s=e.sent,e.abrupt("return",s.json());case 5:return e.next=7,p.post("/api/v1/tarot/share-spread",{spread:t,spread_type:r,user_id:n});case 7:return i=e.sent,e.abrupt("return",i.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(e,t){return S.apply(this,arguments)}function S(){return(S=(0,n.A)(a().mark(function e(t,r){var n,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof fetch){e.next=5;break}return e.next=3,fetch("/api/v1/tarot/spotify-playlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({energy_flows:t,spread_type:r})});case 3:return n=e.sent,e.abrupt("return",n.json());case 5:return e.next=7,p.post("/api/v1/tarot/spotify-playlist",{energy_flows:t,spread_type:r});case 7:return s=e.sent,e.abrupt("return",s.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function C(e){return P.apply(this,arguments)}function P(){return(P=(0,n.A)(a().mark(function e(t){var r,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof fetch){e.next=5;break}return e.next=3,fetch("/api/v1/tarot/location-insights",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip_address:t})});case 3:return r=e.sent,e.abrupt("return",r.json());case 5:return e.next=7,p.post("/api/v1/tarot/location-insights",{ip_address:t});case 7:return n=e.sent,e.abrupt("return",n.data);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}p.interceptors.request.use(function(e){var t=localStorage.getItem("token");return t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),e}),p.interceptors.response.use(function(e){var t,r;return null!=(t=e.config.url)&&t.includes("/api/v1/feed")&&(e.data=l(l({},r=e.data),{},{items:r.items.map(u)})),e})}},e=>{e.O(0,[2909,1040,6848,9924,636,6593,8792],()=>e(e.s=4480)),_N_E=e.O()}]);